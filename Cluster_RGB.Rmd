---
title: "Placenta Analysis - Slide Stain Cluster"
author: "Ilya Kukovitskiy"
date: "July 6, 2018"
output: html_document
self_contained: no
---
  
```{r Seeds_Packages,results='hide',message=FALSE}
set.seed(1)
require(cluster)
require(clValid)
```

# RGB data

## Data Preprocessing

#### Reading in and storing dataset from file

```{r Reading_Files}
x <- read.csv('ProjectStatistics_UNCSlideStainChar.csv')
# for combining datasets later
P <- read.csv('ProjectStatistics_UNCSlideStainChar.csv')
attach(x)
colnames(x)
```

#### Removing undesired variables, scene_name, scene_id, scene_ver

```{r NaN_Column_Removal}
# Removing row 17:
x <- x[,-c(1,2,3)]
attach(x)
```

#### In order to perform cluster analysis, normalizing all columns

```{r Scale}
x.s <- scale(x)
```

## Data Analysis (Scaled)

### Clustering and Plotting

```{r Scaled_Euclidean}
# Euclidean
Euc.s <- clValid(x.s, 2:3, clMethods = c("hierarchical", "kmeans", "diana", "sota", "pam"), validation = c("internal", "stability"), maxitems = 800, metric = "euclidean")
summary(Euc.s)
plot(Euc.s)
```

```{r Scaled_Correlation}
# Correlation
Cor.s <- clValid(x.s, 2:20, clMethods = c("hierarchical", "kmeans", "diana", "sota", "pam"), validation = c("internal", "stability"), maxitems = 800, metric = "correlation")
summary(Cor.s)
plot(Cor.s)
```

### Remove outliers according to distance from centroids of groups. Perhaps, removing one by one and clustering the data after removal. 

## Data Analysis (Not Scaled)

### Clustering and Plotting

```{r Unscaled_Euclidean}
# Euclidean
Euc <- clValid(x, 2:20, clMethods = c("hierarchical", "kmeans", "diana", "sota", "pam"), validation = c("internal", "stability"), maxitems = 800, metric = "euclidean")
summary(Euc)
plot(Euc)
```

```{r Unscaled_Correlation}
# Correlation
Cor <- clValid(x, 2:20, clMethods = c("hierarchical", "kmeans", "diana", "sota", "pam"), validation = c("internal", "stability"), maxitems = 800, metric = "correlation")
summary(Cor)
plot(Cor)
```

### Attaching cluster vector to dataset

```{r Attaching_ClValues}
#x1k2 <- cbind(P,K2$cluster)
```

## Exporting dataset to .csv file

```{r Exporting_File}
#write.csv(x1k2, "ProjectStatistics_UNCSlideStainChar_ClusterK2.csv")
```