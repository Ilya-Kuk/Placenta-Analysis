---
title: "Placenta Analysis - Slide Stain Cluster"
author: "Ilya Kukovitskiy"
date: "July 6, 2018"
output: html_document
self_contained: no
---
  
```{r Seeds_Packages,results='hide',message=FALSE}
set.seed(1)
require(cluster)
require(clValid)
```

# RGB data

## Data Preprocessing

#### Reading in and storing dataset from file

```{r Reading_Files}
x <- read.csv('ProjectStatistics_UNCSlideStainChar.csv')
# Copying dataset for later exporting
Final <- x
colnames(x)
```

#### Removing undesired variables, scene_name, scene_id, scene_ver

```{r NaN_Column_Removal}
# Removing row 17:
x <- x[,-c(1,2,3)]
```

#### In order to perform cluster analysis, normalizing all columns. Analysis will be performed both on original and scaled data.

```{r Scale}
x.s <- scale(x)
```

## Data Analysis (Scaled)

### Clustering and Recording Clusters

#### Scaled

```{r Clustering_Scaled}
# hierarchical
hier.s <- hclust(dist(x.s))
HIER.S <- NULL
for(i in 2:12){
  HIER.S <- cbind(HIER.S, cutree(hier.s, k = i) )
}

# kmeans
KMEANS.S <- NULL
for(i in 2:12){
  KMEANS.S <- cbind(KMEANS.S, kmeans(x.s, centers = i)$cluster )
}

# diana
dia.s <- diana(x.s)
DIA.S <- NULL
for(i in 2:12){
  DIA.S <- cbind(DIA.S, cutree(dia.s, i) )
}

# pam
PAM.S <- NULL
for(i in 2:12){
  pam <- pam(x.s, i, cluster.only = TRUE)
  PAM.S <- cbind(PAM.S, pam)
}
rm(pam)
```

#### Unscaled

```{r Clustering_Unscaled}
# hierarchical
hier.u <- hclust(dist(x))
HIER.U <- NULL
for(i in 2:12){
  HIER.U <- cbind(HIER.U, cutree(hier.u, k = i) )
}

# kmeans
KMEANS.U <- NULL
for(i in 2:12){
  KMEANS.U <- cbind(KMEANS.U, kmeans(x, centers = i)$cluster )
}

# diana
dia.u <- diana(x)
DIA.U <- NULL
for(i in 2:12){
  DIA.U <- cbind(DIA.U, cutree(dia.u, i) )
}

# pam
PAM.U <- NULL
for(i in 2:12){
  pam <- pam(x, i, cluster.only = TRUE)
  PAM.U <- cbind(PAM.U, pam)
}
rm(pam)
```

### Measuring Clustering Effectiveness

#### Scaled

```{r Scaled_Euclidean}
# Euclidean
Euc.s <- clValid(x.s, 2:12, clMethods = c("hierarchical", "kmeans", "diana", "pam"), validation = c("internal", "stability"), maxitems = 800, metric = "euclidean")
summary(Euc.s)
plot(Euc.s)
```

```{r Scaled_Correlation}
# Correlation
Cor.s <- clValid(x.s, 2:12, clMethods = c("hierarchical", "kmeans", "diana", "pam"), validation = c("internal", "stability"), maxitems = 800, metric = "correlation")
summary(Cor.s)
plot(Cor.s)
```

#### Unscaled

```{r Unscaled_Euclidean}
# Euclidean
Euc <- clValid(x, 2:12, clMethods = c("hierarchical", "kmeans", "diana", "pam"), validation = c("internal", "stability"), maxitems = 800, metric = "euclidean")
summary(Euc)
plot(Euc)
```

```{r Unscaled_Correlation}
# Correlation
Cor <- clValid(x, 2:12, clMethods = c("hierarchical", "kmeans", "diana", "pam"), validation = c("internal", "stability"), maxitems = 800, metric = "correlation")
summary(Cor)
plot(Cor)
```

### Attaching cluster vectors to dataset copies

```{r Attaching_Cluster_Values}
# Scaled
Final_Hier.s <- cbind(Final, HIER.S)
Final_Kmeans.s <- cbind(Final, KMEANS.S)
Final_Dia.s <- cbind(Final, DIA.S)
Final_Pam.s <- cbind(Final, PAM.S)
# Unscaled
Final_Hier.u <- cbind(Final, HIER.U)
Final_Kmeans.u <- cbind(Final, KMEANS.U)
Final_Dia.u <- cbind(Final, DIA.U)
Final_Pam.u <- cbind(Final, PAM.U)
```

## Exporting dataset to .csv files

```{r Exporting_File}
# Scaled
write.csv(Final_Hier.s, "ProjectStatistics_UNCSlideStainChar_Cluster_Hier_Scaled.csv")
write.csv(Final_Kmeans.s, "ProjectStatistics_UNCSlideStainChar_Cluster_Kmeans_Scaled.csv")
write.csv(Final_Dia.s, "ProjectStatistics_UNCSlideStainChar_Cluster_Dia_Scaled.csv")
write.csv(Final_Pam.s, "ProjectStatistics_UNCSlideStainChar_Cluster_Pam_Scaled.csv")
# Unscaled
write.csv(Final_Hier.u, "ProjectStatistics_UNCSlideStainChar_Cluster_Hier_Unscaled.csv")
write.csv(Final_Kmeans.u, "ProjectStatistics_UNCSlideStainChar_Cluster_Kmeans_Unscaled.csv")
write.csv(Final_Dia.u, "ProjectStatistics_UNCSlideStainChar_Cluster_Dia_Unscaled.csv")
write.csv(Final_Pam.u, "ProjectStatistics_UNCSlideStainChar_Cluster_Pam_Unscaled.csv")
```